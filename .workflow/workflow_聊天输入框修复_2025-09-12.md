# 功能：聊天输入框位置与主题样式修复

## 核心分析
- **需求目标**：将聊天输入框固定在聊天窗口最底部；在默认与亮色主题下，输入框的背景/边框/文字/占位符颜色与卡片背景保持一致，并修复聚焦态样式异常。
- **范围（In/Out）**：
  - In：`ChatPanel` 布局调整；底栏输入区容器与对齐；Ant Design Input/TextArea 主题 token 调整；必要的全局 CSS 兜底；聚焦态与悬停态边框/阴影；滚动时输入区保持可见（sticky）。
  - Out：消息发送逻辑、快捷键、历史消息加载策略、表情/附件等功能改造。
- **技术选型**：React + Ant Design v5（`ConfigProvider` 主题 token）；按需使用 `position: sticky`；全局 CSS 兜底（作用域限制在聊天面板容器）。
- **非功能需求**：
  - 性能：滚动与输入交互流畅（≥60fps），不引入多余重排。
  - 可运维性：主题 token 为单一真实来源，避免多处硬编码颜色；样式兜底最小可见范围，避免影响全局组件。
  - 可观测性：在开发环境验证暗/亮主题下的视觉一致性；聚焦态高可见。
- **依赖与前置**：AntD 5.x 主题体系；现有主题切换逻辑（`AntdThemeProvider.tsx`）；容器需要有确定高度以保证 sticky 生效。
- **潜在风险**：
  - 父级容器未占满高度导致 sticky 失效；
  - 现有内联样式或第三方样式 `!important` 覆盖链冲突；
  - 全局 token 变更可能影响其他输入类组件，需要限制作用域或提供仅针对聊天面板的覆盖。

# 任务列表
---

## Phase 1: 布局与容器修复
- [x] **Task 1: 为 `ChatPanel` 根容器设置纵向弹性布局与满高（flex column + height: 100%）**
- [x] **Task 2: 将消息列表设为 `flex: 1` 且 `overflow: auto`，避免撑开高度**
- [x] **Task 3: 新增/整理底栏输入区容器（含输入框与发送按钮）并使用 `position: sticky; bottom: 0`**

## Phase 2: 输入框样式与交互
- [x] **Task 4: 统一输入框尺寸与圆角、内边距、按钮对齐；处理多行自适应高度**
- [x] **Task 5: 修复聚焦态边框与阴影，确保与主题一致**

## Phase 3: 主题 token 调整（默认/亮色）
- [x] **Task 6: 在 `AntdThemeProvider.tsx` 中设置与卡片背景一致的输入框背景（使用 `colorBgContainer`）**
- [x] **Task 7: 设置 `colorText`、`colorBorder`、`colorTextPlaceholder` 等 token，确保两种主题下可读性与对比度**

## Phase 4: CSS 兜底（限定作用域）
- [x] **Task 8: 在 `index.css` 中为聊天面板作用域添加 `.ant-input`/`.ant-input-textarea` 的兜底样式（含 placeholder、focus）**
- [ ] **Task 9: 排查并移除可能的内联硬编码颜色或 `!important` 冲突**

## Phase 5: 验证与质量
- [ ] **Task 10: 组件级手动验证（暗/亮主题、窗口缩放、滚动时输入区可见）**
- [ ] **Task 11: Lint/格式化与类型检查（eslint/prettier、`tsc --NoEmit`）**

## Phase 6: 文档与清理
- [ ] **Task 12: 更新工作流文档状态，移除任何临时测试样式/脚本，并标记“清理完成”**

---

## 变更记录
- 2025-09-12T00:00Z：创建任务拆分文档，明确布局与主题 token 方案。
